<% if (searchLocation === 'top') { %>
  <div class="row">
    <div class="col-xs-offset-1 col-xs-10">
    <form action="/" method="get">
      <div class="input-group">
        <input id="query" type="text" class="form-control" name="q" placeholder="Search" ng-model="query">
        <span class="input-group-btn">
          <button type="submit" class="btn btn-default" ng-disabled="!query" ng-class="{disabledLink: !query}"><i class="fa fa-fw fa-search"></i></button>
          <button ng-if="!hasQuery" ng-click="clearSearch()" class="btn btn-default" ng-class="{disabledLink: !query}" ng-disabled="!query"><i class="fa fa-fw fa-times"></i></button>
          <a ng-href="/" ng-if="hasQuery" class="btn btn-default"><i class="fa fa-fw fa-times"></i></a>
        </span>
      </div>
    </form>
    </div>
  </div>
<% } %>
<table class="table table-condensed table-hover table-striped valign">
  <thead class="thead-default">
    <tr>
      <th colspan="2">
          <div class="btn-group" data-toggle="buttons">
            <button type="button" class="btn btn-default btn-sm" ng-click="updateData();" aria-label="Refresh" title="Refresh Messages"><i class="fa fa-refresh {{spinner}}" aria-hidden="true"></i></button>
            <button type="button" ng-if="notificationSupport == true" class="btn btn-default btn-sm" ng-class="{active: notificationEnabled == 'true'}" ng-click="toggleNotifications();" aria-label="Notifications" title="Toggle Browser Notifications">
              <i class="fa fa-bell" aria-hidden="true"></i></button>
          <span class="dropdown">
            <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" title="Message Limit">{{init.limit}} <span class="caret"></span></button>
            <ul class="dropdown-menu" role="menu" style="margin-top: 9px;">
              <li ng-class="{disabled:init.limit == 10}"><a href="#" ng-click="setCookie('messageLimit', 10);">10</a></li>
              <li ng-class="{disabled:init.limit == 20}"><a href="#" ng-click="setCookie('messageLimit', 20);">20</a></li>
              <li ng-class="{disabled:init.limit == 50}"><a href="#" ng-click="setCookie('messageLimit', 50);">50</a></li>
              <li ng-class="{disabled:init.limit == 100}"><a href="#" ng-click="setCookie('messageLimit', 100);">100</a></li>
            </ul>
          </span>
          </div>
      </th>
      <% if (!hidesource || login) { %>
        <th class="noMobile noSmall" style="text-align: center;">Src</th>
      <% } %>
      <% if (!hidecapcode || login) { %>
        <th class="noMobile" style="text-align: center;">Capcode</th>
      <% } %>
      <th class="noMobile noSmall"></th>
      <th class="noMobile noSmall"></th>
      <th style="text-align: center;">Message
        <span ng-if="filter || hasQuery" class="pull-left" style="vertical-align: middle; padding-right: 10px;">
            <strong>Filter:</strong> <a ng-href="/" style="margin-bottom: 3px;" class="btn btn-primary btn-xs">{{filter || origQuery}} <i class="fa fa-fw fa-times"></i></a>
        </span></th>
    </tr>
  </thead>
  <tbody>
    <tr ng-repeat="message in messages | filter: search">
      <td class="shrink noMobile noSmall">{{message.date}}</td>
      <td class="shrink">{{message.timestamp}}</td>
      <% if (!hidesource || login) { %>
        <td class="shrink noMobile noSmall clickable-td" uib-popover-template="'templates/popover.html'" popover-append-to-body=true ng-click="popoverEl = 'source'" popover-trigger="'outsideClick'" style="background-color: {{message.color || 'grey'}}; text-align: center;">
          <span class="small" style="color: white; font-family: monospace;"><strong>{{message.source}}</strong></span>
        </td>
      <% } %>
      <% if (!hidecapcode || login) { %>
        <td class="shrink noMobile noSmall clickable-td" uib-popover-template="'templates/popover.html'" popover-append-to-body=true ng-click="popoverEl = 'address'" popover-trigger="'outsideClick'" style="background-color: {{message.color || 'grey'}}; text-align: center;">
          <span class="small" style="color: white; font-family: monospace;"><strong>{{message.address}}</strong></span>
        </td>
      <% } %>
      <td class="shrink clickable-td" ng-if="message.agency" uib-popover-template="'templates/popover.html'" popover-append-to-body=true ng-click="popoverEl = 'agency'" popover-trigger="'outsideClick'">
        <% if (iconsize == 'small') { %>
        <span class="fa-stack fa-fw" style="color: {{message.color || 'grey'}};">
        <% } else { %>
        <span class="fa-stack fa-lg fa-fw" style="color: {{message.color || 'grey'}};">
        <% } %>
          <i class="fa fa-circle fa-stack-2x"></i>
          <i ng-if="message.icon" class="fa fa-{{message.icon}} fa-stack-1x fa-inverse"></i>
          <i ng-if="!message.icon" class="fa fa-question fa-stack-1x fa-inverse"></i>
        </span>
        <strong style="vertical-align: middle;">{{message.agency || ''}}</strong>
      </td>
      <td class="shrink" ng-if="!message.agency">
        <% if (iconsize == 'small') { %>
        <span class="fa-stack fa-fw" style="color: {{message.color || 'grey'}};">
        <% } else { %>
        <span class="fa-stack fa-lg fa-fw" style="color: {{message.color || 'grey'}};">
        <% } %>
          <i class="fa fa-circle fa-stack-2x"></i>
          <i ng-if="message.icon" class="fa fa-{{message.icon}} fa-stack-1x fa-inverse"></i>
          <i ng-if="!message.icon" class="fa fa-question fa-stack-1x fa-inverse"></i>
        </span>
        <strong style="vertical-align: middle;"></strong>
      </td>
      <td class="shrink noMobile noSmall clickable-td" ng-if="user" uib-popover-template="'templates/popover.html'" popover-append-to-body=true ng-click="popoverEl = 'alias'" popover-trigger="'outsideClick'">
        <span style="color: Maroon;">{{message.alias || 'Unknown'}}</span>
      </td>
      <td class="shrink noMobile noSmall" ng-if="!user">
        <span>{{message.alias || ''}}</span>
      </td>
      <td class="expand"><div highlight="message.message" replacement="init.replaceText" class="pagerMessage"></td>
  </tbody>
</table>
